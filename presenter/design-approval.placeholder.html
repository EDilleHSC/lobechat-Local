<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Design Approval (Test Placeholder)</title>
    <style>
      body { font-family: Arial, sans-serif; padding: 24px }
      button { padding: 8px 12px; }
      #demoModal { display:none; border:1px solid #ddd; padding:12px; position:fixed; right:24px; top:72px; background:#fff }
      #demoModal.open { display:block }
      .complete { text-decoration:line-through }
    </style>
  </head>
  <body>
    <h1>Design Approval (Placeholder)</h1>
    <button id="btnDemoToggle" onclick="toggleDemoMode()">Try UX Demo Mode</button>

    <div style="margin-top:16px">
      <label>Approved By <input id="signatureName"></label><br>
      <label>Notes <textarea id="approvalNotes"></textarea></label><br>
      <button id="btnApprove" onclick="approveDesign()">Confirm Approval</button>
    </div>

    <div id="demoModal" role="dialog" aria-modal="true" aria-labelledby="demoTitle" aria-hidden="true">
      <h3 id="demoTitle" tabindex="-1">UX Demo Mode</h3>
      <ul id="demoChecklist">
        <li data-step="1">Fill out name & role</li>
        <li data-step="2">Add notes</li>
        <li data-step="3">Submit approval (demo)</li>
      </ul>
      <button onclick="resetDemo()">Restart Demo</button>
      <button onclick="exitDemoMode()">Close</button>
    </div>

    <div id="toast" role="status" aria-live="polite" aria-atomic="true" style="display:none; border:1px solid #ccc; padding:8px; position:fixed; bottom:24px; right:24px; background:#eee"></div>

    <script>
      let demoMode=false; let demoState={steps:{}}; let _previousActiveElement=null; let _trapHandler=null;
      function toggleDemoMode(){ demoMode?exitDemoMode():enterDemoMode(); }
      function _trapFocus(e){
        if(e.key !== 'Tab') return;
        const modal = document.getElementById('demoModal');
        const focusable = Array.from(modal.querySelectorAll('button, [href], input, textarea, [tabindex]:not([tabindex="-1"])')).filter(el => !el.hasAttribute('disabled'));
        if(focusable.length===0) return;
        const first = focusable[0];
        const last = focusable[focusable.length-1];
        if(e.shiftKey){ if(document.activeElement === first){ e.preventDefault(); last.focus(); } }
        else { if(document.activeElement === last){ e.preventDefault(); first.focus(); } }
      }
      function enterDemoMode(){
        demoMode=true;
        const modal=document.getElementById('demoModal');
        _previousActiveElement = document.activeElement;
        modal.classList.add('open');
        modal.setAttribute('aria-hidden','false');
        _trapHandler = _trapFocus;
        modal.addEventListener('keydown', _trapHandler);
        document.getElementById('demoTitle').focus();
        showToast('Demo Mode enabled');
      }
      function exitDemoMode(){
        demoMode=false;
        const modal=document.getElementById('demoModal');
        modal.classList.remove('open');
        modal.setAttribute('aria-hidden','true');
        if(_trapHandler) modal.removeEventListener('keydown', _trapHandler);
        if(_previousActiveElement && _previousActiveElement.focus) _previousActiveElement.focus();
        showToast('Demo Mode disabled');
      }
      function markDemoStepCompleted(s){ demoState.steps[s]=true; document.querySelectorAll('#demoChecklist li').forEach(li=>{ if(demoState.steps[li.getAttribute('data-step')]) li.classList.add('complete') }) }
      function approveDesign(){ const name=document.getElementById('signatureName').value; if(!name.trim()){ showToast('Please enter your name'); return } if(demoMode){ markDemoStepCompleted('1'); markDemoStepCompleted('3'); showToast('Demo: Approval submitted (no write)'); return } showToast('Approved by '+name) }
      function resetDemo(){ demoState={steps:{}}; document.querySelectorAll('#demoChecklist li').forEach(li=>li.classList.remove('complete')); showToast('Demo reset') }
      function showToast(msg){ const t=document.getElementById('toast'); t.innerText=msg; t.style.display='block'; setTimeout(()=>t.style.display='none',3000) }
    </script>
  </body>
</html>